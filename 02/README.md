## [HC](https://codeforces.com/gym/101190/problem/C)
ACM ICPC 2016–2017, Northeastern European Regional Contest, Problem C

Solved at 2022.10.15 (+1)

题意：

给出一个包含 $n$ 个结点 $m$ 条边的仙人掌图，要求使用以下操作构造：

- 选择两个点 $u,v$，将 $u,v$ 所在的集合合并
- 将 $u$ 所在集合中颜色为 $c_1$ 的点染色为 $c_2$
- 将 $u$ 所在集合中颜色为 $c_1$ 和 $c_2$ 的点之间连边，不允许出现重边

初始的集合为 $n$ 个仅包含一个结点的集合，所有结点颜色初始为 $1$，只能使用 $4$ 种颜色。

题解：

首先根据仙人掌图建圆方树。我们需要构造的边有两类，环上的边和环间的边。我们考虑在方点处构造环上的边，圆点处构造环间的边。

一个很自然的想法是，要构造一棵圆方树对应的仙人掌上的边，我们可以先构造其所有子树对应的边，然后根据根节点讨论如何构造该节点周围的边。我们将构造完边的点用 $1$ 染色，圆根节点用 $4$ 染色，剩下两个颜色在构造中使用。那么，如果根是圆结点，我们要返回一棵除了根节点其他节点颜色都是 $1$ 的构造；如果根是方结点，我们需要在不改变根节点父亲颜色的情况下构造方结点对应的环和后面的部分。

如果根节点是圆节点，我们先将根节点染上 $4$，然后对其所有子节点递归构造。方子节点对应的子树会将根节点连的环边也构造出来，所以只考虑圆子节点。对于圆子节点，我们将其根的 $4$ 全部改成临时的 $2$ 并与根节点集合合并，再在 $4$ 和 $2$ 之间连边，并将临时的 $2$ 改为构造完成的 $1$。

如果根节点是方结点，我们对所有子节点递归构造，然后构造方结点对应的环。我们用 $3$ 表示待加入的结点根，$2$ 表示目前加入结点形成环上链的末尾。除了开头和结尾需要讨论，我们只需要将代加入的结点的 $4$ 改成 $3$，合并其与环的集合，在 $2$ 与 $3$ 之间连边，将 $2$ 改为构造完成的 $1$ 再将 $3$ 改为链末尾的 $2$.


## [IB](https://codeforces.com/gym/100851/problem/B)
ACM ICPC 2015–2016, Northeastern European Regional Contest, Problem B

Solved at 2022.10.15 (+1)

题意：

找到第 $n$ 大的满足条件的数，条件为其十进制表达是二进制表达的后缀。

题解：

因为 $10^k=2^k\cdot 5^k$，所以十进制上第 $k$ 位上的 $1$ 会影响其二进制位的第 $k$ 位开始的一些位置，并且一定会影响第 $k$ 位。

可以发现一个性质，如果一个 $k$ 位十进制数 $n$ 不符合条件，那么以 $n$ 为后缀的数都不符合条件，因为这个数的二进制的后 $k$ 位和 $n$ 的二进制相同后 $k$ 位相同，即与 $n$ 的十进制不同。因此可以维护全部的满足条件的数，第 $k$ 轮尝试将所有满足条件的数加上 $10^k$，如果合法则加入集合，这样迭代到集合中有超过 $n$ 个数。这样可以快速求出前 $10^3$ 个数，但无法快速求出前 $10^4$ 个数。

还可以发现，这个性质可以进一步加强。如果 $k$ 位十进制数 $n$ 不符合条件，因为其第 $k$ 位只会影响其二进制的第 $k$ 位，因此将这一位变成 $0$ 也不符合条件。因此，以 $n$ 的后 $k-1$ 位为后缀的数也不符合条件。因此，当一个满足条件的数加上 $10^k$ 之后不满足条件，那么它之后都不会再满足条件，可以将其移出集合。这样每个数只会被加入和移出集合一次，求前 $n$ 个满足条件的数的复杂度即为 $O(nk)$，其中 $k$ 为集合中数的位数或高精度加法的复杂度。


## [FJ](https://codeforces.com/gym/102511/problem/J)
ICPC 2019, World Finals, Problem J

Solved at 2022.11.08 (+5)

题意：

有 $n$ 个人打高尔夫，每个人打 $m$ 个洞，第 $i$ 个人把球打进第 $j$ 个洞花了 $a_{i,j}$ 杆。现在规定第 $i$ 个人的分数是 $\Sigma_j \min(a_{i,j},k)$，其中 $k$ 是一个任意的整数。规定每个人的排名是小于等于其分数的人数，求每个人可能的最高排名。

题解：

可以将每个人的分数关于 $k$ 的变化看作一条 $m$ 个端点的凸折线。因为其有凸性，所以总交点数是 $O(n^2m)$ 级别的。

将每个人的排名初始化为 $n$，然后枚举折线的全部交点。在交点处对排名进行 $\pm 1$ 的操作，并在过程中记录每个人在整点处的最高排名。